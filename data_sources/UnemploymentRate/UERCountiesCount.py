import sysfrom csv import readerfrom pyspark import SparkContextsc = SparkContext()data = sc.textFile(sys.argv[1], 1).mapPartitions(lambda x: reader(x))result = data.sortBy(lambda x: x[0]).filter(lambda x: "00" not in x)outputTotal = result.map(lambda x: x[0] + "," + x[1] + "-" + x[2] + "," + x[6])outputTotal.saveAsTextFile("UERCountiesCount.out")#for each county# New York County (Manhattan), Kings County (Brooklyn), Bronx County (The Bronx), Richmond County (Staten Island), and Queens County (Queens)NewYorkCounty = result.filter(lambda x: "New York County" in x).map(lambda x: x[1] + "-" + x[2] + "," + x[6])NewYorkCounty.saveAsTextFile("UERNewYorkCounty.out")KingsCounty = result.filter(lambda x: "Kings County" in x).map(lambda x: x[1] + "-" + x[2] + "," + x[6])KingsCounty.saveAsTextFile("UERKingsCounty.out")BronxCounty = result.filter(lambda x: "Bronx County" in x).map(lambda x: x[1] + "-" + x[2] + "," + x[6])BronxCounty.saveAsTextFile("UERBronxCounty.out")RichmondCounty = result.filter(lambda x: "Richmond County" in x).map(lambda x: x[1] + "-" + x[2] + "," + x[6])RichmondCounty.saveAsTextFile("UERRichmondCounty.out")QueensCounty = result.filter(lambda x: "Queens County" in x).map(lambda x: x[1] + "-" + x[2] + "," + x[6])QueensCounty.saveAsTextFile("UERQueensCounty.out")'''Cols:"AREA", 0"YEAR",  1"MONTH", 2"LABORFORCE", 3"EMP", 4"UNEMP", 5"UNEMPRATE" 6####COMMAND####    module load python/gnu/3.6.5module load spark/2.4.0rm -rf UERCountiesCount.outrm -rf UERNewYorkCounty.outrm -rf UERKingsCounty.outrm -rf UERBronxCounty.outrm -rf UERRichmondCounty.outrm -rf UERQueensCounty.outhfs -rm -R UERCountiesCount.outhfs -rm -R UERNewYorkCounty.outhfs -rm -R UERKingsCounty.outhfs -rm -R UERBronxCounty.outhfs -rm -R UERRichmondCounty.outhfs -rm -R UERQueensCounty.outspark-submit --conf \spark.pyspark.python=/share/apps/python/3.6.5/bin/python \UERCountiesCount.py countiesUER.csvhfs -getmerge UERCountiesCount.out UERCountiesCount.outhfs -getmerge UERNewYorkCounty.out UERNewYorkCounty.outhfs -getmerge UERKingsCounty.out UERKingsCounty.outhfs -getmerge UERBronxCounty.out UERBronxCounty.outhfs -getmerge UERRichmondCounty.out UERRichmondCounty.outhfs -getmerge UERQueensCounty.out UERQueensCounty.outhfs -rm -R UERCountiesCount.outhfs -rm -R UERNewYorkCounty.outhfs -rm -R UERKingsCounty.outhfs -rm -R UERBronxCounty.outhfs -rm -R UERRichmondCounty.outhfs -rm -R UERQueensCounty.outhead UERCountiesCount.outhead UERNewYorkCounty.outhead UERKingsCounty.outhead UERBronxCounty.outhead UERRichmondCounty.outhead UERQueensCounty.out'''